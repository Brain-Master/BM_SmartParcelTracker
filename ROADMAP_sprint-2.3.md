# –ü–ª–∞–Ω —Å–ø—Ä–∏–Ω—Ç–∞ 2.3 ‚Äî –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ 2.2 –∏ –ø—Ä–∏—ë–º–∫–∞

**–ü—Ä–æ–µ–∫—Ç:** BM Smart Parcel Tracker  
**–°–ø—Ä–∏–Ω—Ç:** 2.3  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 3‚Äì4 –Ω–µ–¥–µ–ª–∏ (15‚Äì20 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)  
**–§–æ–∫—É—Å:** –ì–ª–∞–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Ñ–∏—á–∞ ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞; –∑–∞—Ç–µ–º –∫–µ—à/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —Ä–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–∑–∏—Ü–∏–π. –í–∏–¥ ¬´–ü–æ —Å—Ç–∞—Ç—É—Å—É¬ª –æ—Ç–º–µ–Ω—ë–Ω ‚Äî –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Å–µ—Ö –≤–∏–¥–∞—Ö Dashboard.  
**–°—Ç–∞—Ç—É—Å:** üìã –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω  
**–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ø—Ä–∏–Ω—Ç:** 2.2 ‚Äî üöß —á–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω (Split, 3 view, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –∞—Ä—Ö–∏–≤, —Ñ–æ—Ä–º—É–ª–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏)  
**–°—Å—ã–ª–∫–∏:** [ROADMAP_now.md](./ROADMAP_now.md), [ROADMAP_sprint-2.2.md](./ROADMAP_sprint-2.2.md), [ROADMAP_sprint-2.2-DETAILED.md](./ROADMAP_sprint-2.2-DETAILED.md)

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

### –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ –≤ 2.2

- ‚úÖ Task 2.2.1: Split shipments (ParcelItem junction, ParcelForm, Dashboard)
- ‚úÖ Task 2.2.3: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ (is_archived, ¬´–ü–æ–∫–∞–∑–∞—Ç—å –∞—Ä—Ö–∏–≤¬ª)
- ‚úÖ Task 2.2.4: –§–æ—Ä–º—É–ª–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–∞ (shipping_cost, customs_cost, breakdown –≤ OrderForm –∏ Dashboard)
- ‚úÖ Task 2.2.2: –¢—Ä–∏ –≤–∏–¥–∞ Dashboard (–ó–∞–∫–∞–∑—ã, –ü–æ—Å—ã–ª–∫–∏, –¢–æ–≤–∞—Ä—ã) —Å **–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –≤–æ –≤—Å–µ—Ö –≤–∏–¥–∞—Ö**; –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–∏–¥ ¬´–ü–æ —Å—Ç–∞—Ç—É—Å—É¬ª –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª–∏ ‚Äî —Ä–µ—à–µ–Ω–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –≤ –ø–æ–ª—å–∑—É –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

### –°—Ç–∞—Ä—Ç —Å–ø—Ä–∏–Ω—Ç–∞: –≥–ª–∞–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Ñ–∏—á–∞ ‚úÖ

| ‚Ññ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|---|--------|--------|
| 0 | **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –∫–Ω–æ–ø–∫–∞ üì∑ —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º –ø–æ–∏—Å–∫–∞ –Ω–∞ Dashboard; –∫–∞–º–µ—Ä–∞ + –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ; —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫ (–ø–æ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä—É –∏ –¥—Ä.). |

### –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å (–æ–±—ä—ë–º —Å–ø—Ä–∏–Ω—Ç–∞ 2.3)

| ‚Ññ | –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –û—Ü–µ–Ω–∫–∞ |
|---|--------|-----------|--------|
| 1 | **2.2.7** –°—Ç–∞—Ç—É—Å—ã –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–æ—Å—ã–ª–∫–∞–º–∏ | –í—ã—Å–æ–∫–∏–π | 2‚Äì3 –¥–Ω—è |
| 2 | **2.2.5** Client cache –∏ polling (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É / —Ä–∞–∑ –≤ N –º–∏–Ω) | –°—Ä–µ–¥–Ω–∏–π | 1‚Äì2 –¥–Ω—è |
| 3 | **2.2.6** –†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏: mark-received, –ø–æ–∏—Å–∫ –ø–æ –∫–µ—à—É, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª | –°—Ä–µ–¥–Ω–∏–π | 2‚Äì3 –¥–Ω—è |

---

## –¶–µ–ª–∏ —Å–ø—Ä–∏–Ω—Ç–∞ 2.3

1. **–°—Ç–∞—Ç—É—Å—ã –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:** –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å—ã–ª–∫–∏ –Ω–∞ ¬´–î–æ—Å—Ç–∞–≤–ª–µ–Ω–∞¬ª –∏–ª–∏ ¬´–ü–æ—Ç–µ—Ä—è–Ω–∞¬ª —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è (quantity_received, item_status); –≤ enum –¥–æ–±–∞–≤–ª–µ–Ω Lost; –≤ UI –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã.
2. **Dashboard:** —Ç—Ä–∏ –≤–∏–¥–∞ (–ó–∞–∫–∞–∑—ã, –ü–æ—Å—ã–ª–∫–∏, –¢–æ–≤–∞—Ä—ã) —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –≤–æ –≤—Å–µ—Ö –≤–∏–¥–∞—Ö (–æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–∏–¥ ¬´–ü–æ —Å—Ç–∞—Ç—É—Å—É¬ª –Ω–µ –¥–µ–ª–∞–µ–º).
3. **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ pull-to-refresh –∏/–∏–ª–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ N –º–∏–Ω—É—Ç; –µ–¥–∏–Ω—ã–π —Å–ª–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–æ–≤.
4. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–æ–∏—Å–∫–µ:** QR/—à—Ç—Ä–∏—Ö–∫–æ–¥ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ Dashboard (–∫–∞–º–µ—Ä–∞ + –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ) ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞. ‚úÖ –°–¥–µ–ª–∞–Ω–æ.
5. **–†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏:** —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª, –ø–æ–∏—Å–∫ –ø–æ—Å—ã–ª–∫–∏ –ø–æ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä—É –ø–æ –∫–µ—à—É, –æ—Ç–º–µ—Ç–∫–∞ ¬´–ø–æ–ª—É—á–µ–Ω–∞¬ª (mark-received).

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- [ ] –ü—Ä–∏ —Å–º–µ–Ω–µ –ø–æ—Å—ã–ª–∫–∏ –Ω–∞ Delivered: —É —Å–≤—è–∑–∞–Ω–Ω—ã—Ö order_items –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è quantity_received –∏ item_status (Received / Partially_Received).
- [ ] –ü—Ä–∏ —Å–º–µ–Ω–µ –ø–æ—Å—ã–ª–∫–∏ –Ω–∞ Lost: —É —Å–≤—è–∑–∞–Ω–Ω—ã—Ö order_items item_status = Lost.
- [ ] –í enum OrderItemStatus –µ—Å—Ç—å Lost; –≤ UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è ¬´–ü–æ—Ç–µ—Ä—è–Ω–æ¬ª; —Ä—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ.
- [ ] –í Dashboard —Ç—Ä–∏ –≤–∏–¥–∞ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π (–ó–∞–∫–∞–∑—ã, –ü–æ—Å—ã–ª–∫–∏, –¢–æ–≤–∞—Ä—ã).
- [ ] –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ —Ä–∞–∑ –≤ N –º–∏–Ω—É—Ç.
- [x] –í –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ Dashboard: –∫–Ω–æ–ø–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞; —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫ (–ø–æ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä—É –∏ –¥—Ä.).
- [ ] –†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏: –≤–≤–æ–¥/—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞ ‚Üí –ø–æ–∏—Å–∫ –ø–æ –∫–µ—à—É ‚Üí mark-received; backend endpoint POST /parcels/{id}/mark-received.
- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏ (pytest); 0 –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞ (ruff, eslint).

---

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```mermaid
graph LR
  T7[2.2.7 –°—Ç–∞—Ç—É—Å—ã + sync] --> UI[UI —Å—Ç–∞—Ç—É—Å–æ–≤]
  T5[2.2.5 –ö–µ—à + polling] --> T6[2.2.6 –†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏]
  UI --> Done[–°–ø—Ä–∏–Ω—Ç 2.3 –≥–æ—Ç–æ–≤]
  T6 --> Done
  T5 --> Done
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:**  
**–°—Ç–∞—Ä—Ç —Å–ø—Ä–∏–Ω—Ç–∞:** –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ ‚Äî ‚úÖ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–∫–Ω–æ–ø–∫–∞ üì∑, –∫–∞–º–µ—Ä–∞ + —Ñ–∞–π–ª, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–æ–∏—Å–∫).  
**–ù–µ–¥–µ–ª—è 1:** Task 2.2.7 (Backend: Lost + sync –ø—Ä–∏ Delivered/Lost; Frontend: —Ç–∏–ø—ã, –ø–æ–¥–ø–∏—Å–∏, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ).  
**–ù–µ–¥–µ–ª—è 2:** Task 2.2.5 (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π refetch, –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª).  
**–ù–µ–¥–µ–ª—è 3:** Task 2.2.6 (Backend: mark-received; Frontend: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª, –ø–æ–∏—Å–∫ –ø–æ –∫–µ—à—É, –≤—ã–∑–æ–≤ mark-received).  
**–ù–µ–¥–µ–ª—è 4:** –¢–µ—Å—Ç—ã, –ø–æ–ª–∏—Ä–æ–≤–∫–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ROADMAP.

---

## –ù–µ–¥–µ–ª—è 1: –°—Ç–∞—Ç—É—Å—ã –ø–æ–∑–∏—Ü–∏–π –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–æ—Å—ã–ª–∫–∞–º–∏ (2.2.7)

### Backend

| –®–∞–≥ | –§–∞–π–ª | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|------|----------|
| 1 | `backend/app/models/enums.py` | –î–æ–±–∞–≤–∏—Ç—å `Lost = "Lost"` –≤ `OrderItemStatus`. |
| 2 | `backend/alembic/versions/013_add_order_item_status_lost.py` | –ú–∏–≥—Ä–∞—Ü–∏—è: `ALTER TYPE orderitemstatus ADD VALUE IF NOT EXISTS 'Lost'`. |
| 3 | `backend/app/services/parcel_service.py` (–∏–ª–∏ `order_item_status_sync.py`) | –ü–æ—Å–ª–µ `update_parcel`: –ø—Ä–∏ —Å–º–µ–Ω–µ status –Ω–∞ **Delivered** ‚Äî –ø–æ parcel_items —É–≤–µ–ª–∏—á–∏—Ç—å —É order_item `quantity_received` –Ω–∞ quantity, –≤—ã—Å—Ç–∞–≤–∏—Ç—å item_status = Received –∏–ª–∏ Partially_Received; –ø—Ä–∏ **Lost** ‚Äî –≤—ã—Å—Ç–∞–≤–∏—Ç—å item_status = Lost –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö order_items. |
| 4 | `backend/app/schemas/order_item.py` | –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è `Lost`. |

**DoD Backend 2.2.7:**  
- [ ] Enum Lost, –º–∏–≥—Ä–∞—Ü–∏—è 013 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.  
- [ ] –ü—Ä–∏ PUT –ø–æ—Å—ã–ª–∫–∏ status=Delivered: —Å–≤—è–∑–∞–Ω–Ω—ã–µ order_items –æ–±–Ω–æ–≤–ª—è—é—Ç quantity_received –∏ item_status.  
- [ ] –ü—Ä–∏ PUT –ø–æ—Å—ã–ª–∫–∏ status=Lost: —Å–≤—è–∑–∞–Ω–Ω—ã–µ order_items ‚Üí item_status=Lost.  
- [ ] –¢–µ—Å—Ç—ã: —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞+–ø–æ–∑–∏—Ü–∏–∏+–ø–æ—Å—ã–ª–∫–∏+parcel_item; update parcel –Ω–∞ Delivered/Lost ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ order_item.

### Frontend

| –®–∞–≥ | –§–∞–π–ª | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|------|----------|
| 1 | `frontend/src/types/index.ts` | –î–æ–±–∞–≤–∏—Ç—å `'Lost'` –≤ `OrderItemStatus`; –≤ `ORDER_ITEM_STATUS_LABELS`: `Lost: '–ü–æ—Ç–µ—Ä—è–Ω–æ'`. |
| 2 | `frontend/src/pages/DesktopDashboard.tsx` | –î–ª—è —Å—Ç–∞—Ç—É—Å–∞ Lost –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å ¬´–ü–æ—Ç–µ—Ä—è–Ω–æ¬ª (—á–µ—Ä–µ–∑ ORDER_ITEM_STATUS_LABELS). |
| 3 | `frontend/src/pages/OrderForm.tsx` (–∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∑–∏—Ü–∏–∏) | –í—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ (–≤–∫–ª—é—á–∞—è Lost, Cancelled –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ). |

**DoD Frontend 2.2.7:**  
- [ ] –í –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–∫–∞–∑–∞ –∏ –≤ –≤–∏–¥–∞—Ö Dashboard —Å—Ç–∞—Ç—É—Å ¬´–ü–æ—Ç–µ—Ä—è–Ω–æ¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.  
- [ ] –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–∏ (–≤ —Ç.—á. –ü–æ—Ç–µ—Ä—è–Ω–æ, –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω) –≤–æ–∑–º–æ–∂–Ω–æ.

---

## –ù–µ–¥–µ–ª—è 2: –ö–µ—à –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (2.2.5)

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –û—Ç–¥–µ–ª—å–Ω—ã–π –≤–∏–¥ ¬´–ü–æ —Å—Ç–∞—Ç—É—Å—É¬ª –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ–º ‚Äî –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ –≤–æ –≤—Å–µ—Ö —Ç—Ä—ë—Ö –≤–∏–¥–∞—Ö Dashboard (–ó–∞–∫–∞–∑—ã, –ü–æ—Å—ã–ª–∫–∏, –¢–æ–≤–∞—Ä—ã) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞. Task 2.2.2 —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –≤ —ç—Ç–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ.

### Task 2.2.5: Client cache –∏ polling

**–¶–µ–ª—å:** –ï–¥–∏–Ω—ã–π —Å–ª–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–æ–≤ (orders —Å items, parcels); –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ä–∞–∑ –≤ N –º–∏–Ω—É—Ç (—Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω –≤ foreground).

**–§–∞–π–ª—ã:**  
- `frontend/src/hooks/useOrders.ts`, `useParcels.ts`: refetch –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –æ–∫–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ), —è–≤–Ω—ã–π refetch –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π.  
- `frontend/src/pages/DesktopDashboard.tsx`: –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª (–≤—ã–∑–æ–≤ refetch orders + parcels); –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `setInterval(refetch, 2*60*1000)` –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏, –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ unmount.  
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ –∫–æ–¥–µ –∏–ª–∏ –≤ System Design.

**DoD:**  
- [ ] –ö–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –∏ –ø–æ—Å—ã–ª–æ–∫.  
- [ ] –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è/–∞—Ä—Ö–∏–≤–∞ —Å–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (refetch –∏–ª–∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è).  
- [ ] –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ 2‚Äì5 –º–∏–Ω—É—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–∞—à–±–æ—Ä–¥–µ.

---

## –ù–µ–¥–µ–ª—è 3: –†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏ (2.2.6)

### Backend

| –®–∞–≥ | –§–∞–π–ª | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|------|----------|
| 1 | `backend/app/services/parcel_service.py` | –§—É–Ω–∫—Ü–∏—è `mark_parcel_received(db, parcel_id, user_id)`: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å status=Delivered; –≤—ã–∑–≤–∞—Ç—å —Ç—É –∂–µ –ª–æ–≥–∏–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, —á—Ç–æ –∏ –ø—Ä–∏ update_parcel –Ω–∞ Delivered (quantity_received, item_status —É —Å–≤—è–∑–∞–Ω–Ω—ã—Ö order_items). |
| 2 | `backend/app/api/parcels.py` | Endpoint `POST /api/parcels/{id}/mark-received` (auth); –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞; –≤—ã–∑–æ–≤ `mark_parcel_received`. |

**DoD Backend:**  
- [ ] POST /parcels/{id}/mark-received –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ—Å—ã–ª–∫—É –≤ Delivered –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ order_items.  
- [ ] –¢–µ—Å—Ç: mark-received ‚Üí parcel.status=Delivered, order_item.quantity_received –∏ item_status –æ–±–Ω–æ–≤–ª–µ–Ω—ã.

### Frontend

| –®–∞–≥ | –§–∞–π–ª | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|------|----------|
| 1 | –°—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª | –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä `/receive`), –º–∞—Ä—à—Ä—É—Ç –≤ App.tsx, —Å—Å—ã–ª–∫–∞ –≤ AppLayout. |
| 2 | –õ–æ–≥–∏–∫–∞ | –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞ (Enter –∏–ª–∏ –∫–Ω–æ–ø–∫–∞); –ø–æ–∏—Å–∫ –ø–æ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º—É –∫–µ—à—É –ø–æ—Å—ã–ª–æ–∫ (parcels –∏–∑ useParcels); –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ—Å—ã–ª–∫–∏ –∏ –∫–Ω–æ–ø–∫—É ¬´–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω–æ–π¬ª. |
| 3 | API | –í—ã–∑–æ–≤ POST /parcels/{id}/mark-received; –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ ‚Äî refetch parcels/orders –∏ –ø–æ–∫–∞–∑–∞—Ç—å ¬´–ü—Ä–∏–Ω—è—Ç–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏¬ª (–ª–æ–∫–∞–ª—å–Ω—ã–π state). |

**DoD Frontend:**  
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç ¬´–ü—Ä–∏—ë–º–∫–∞¬ª, –≤–≤–æ–¥–∏—Ç —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä, –ø–æ—Å—ã–ª–∫–∞ –∏—â–µ—Ç—Å—è –ø–æ –∫–µ—à—É –∏ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–π.  
- [ ] –¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è (–æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ quantity_received –∏ item_status –ø–æ—Å–ª–µ refetch).

---

## –ù–µ–¥–µ–ª—è 4: –¢–µ—Å—Ç—ã, –ø–æ–ª–∏—Ä–æ–≤–∫–∞

### –°–∫–∞–Ω–µ—Ä QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞ Dashboard (–≥–ª–∞–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Ñ–∏—á–∞). –ö–Ω–æ–ø–∫–∞ üì∑ —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º –ø–æ–∏—Å–∫–∞; –∫–∞–º–µ—Ä–∞ + –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ; —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫ (—Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä –∏ –¥—Ä.). –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª (Task 2.2.6) –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `BarcodeScannerModal`.

### –¢–µ—Å—Ç—ã –∏ CI

- **Backend:** —Ç–µ—Å—Ç—ã 2.2.7 (sync –ø—Ä–∏ Delivered/Lost), —Ç–µ—Å—Ç mark-received; —Ü–µ–ª–µ–≤–æ–π –æ–±—ä—ë–º ‚â• 38 pytest.  
- **Frontend:** ESLint, tsc –±–µ–∑ –æ—à–∏–±–æ–∫; —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö 4 –≤–∏–¥–æ–≤, –ø—Ä–∏—ë–º–∫–∏, —Å—Ç–∞—Ç—É—Å–æ–≤.  
- **CI:** –≤—Å–µ —à–∞–≥–∏ –≤ `.github/workflows/ci.yml` –ø—Ä–æ—Ö–æ–¥—è—Ç.

---

## –°–≤–æ–¥–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `frontend/src/components/BarcodeScannerModal.tsx` ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è QR/—à—Ç—Ä–∏—Ö–∫–æ–¥–∞ (–∫–∞–º–µ—Ä–∞ + –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ). ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ.
- `backend/alembic/versions/013_add_order_item_status_lost.py`
- `frontend/src/pages/Receive.tsx` (–∏–ª–∏ `ReceivePage.tsx`) ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏—ë–º–∫–∏
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `backend/app/services/order_item_status_sync.py` (–µ—Å–ª–∏ –ª–æ–≥–∏–∫—É –≤—ã–Ω–æ—Å—è—Ç –∏–∑ parcel_service)
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `backend/tests/test_order_item_status_sync.py`

### –ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã

- `backend/app/models/enums.py` ‚Äî Lost –≤ OrderItemStatus
- `backend/app/services/parcel_service.py` ‚Äî sync –ø—Ä–∏ update status; mark_parcel_received
- `backend/app/api/parcels.py` ‚Äî POST mark-received
- `frontend/src/types/index.ts` ‚Äî Lost, –ø–æ–¥–ø–∏—Å–∏
- `frontend/src/pages/DesktopDashboard.tsx` ‚Äî –∫–Ω–æ–ø–∫–∞ —Å–∫–∞–Ω–µ—Ä–∞ üì∑ –≤ –ø–∞–Ω–µ–ª–∏ –ø–æ–∏—Å–∫–∞, –∫–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Å–µ—Ö –≤–∏–¥–∞—Ö —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞)
- `frontend/src/pages/OrderForm.tsx` ‚Äî –≤—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è Lost)
- `frontend/src/App.tsx` ‚Äî –º–∞—Ä—à—Ä—É—Ç /receive
- `frontend/src/components/AppLayout.tsx` ‚Äî —Å—Å—ã–ª–∫–∞ ¬´–ü—Ä–∏—ë–º–∫–∞¬ª
- `frontend/src/hooks/useParcels.ts` / `useOrders.ts` ‚Äî refetch, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∫–µ—à–∞

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

| –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-----------|
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ Lost –≤ split-–ø–æ—Å—ã–ª–∫–∞—Ö (—á–∞—Å—Ç—å –≤ –æ–¥–Ω–æ–π, —á–∞—Å—Ç—å –≤ –¥—Ä—É–≥–æ–π) | –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –ø—Ä–∏ Lost –ø–æ –≤—Å–µ–º order_item –∏–∑ parcel_items —ç—Ç–æ–π –ø–æ—Å—ã–ª–∫–∏ –≤—ã—Å—Ç–∞–≤–∏—Ç—å Lost; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–∑–∂–µ —É—Ç–æ—á–Ω–∏—Ç—å ¬´—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å—è –ø–æ–∑–∏—Ü–∏—è –≤ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø–æ—Å—ã–ª–∫–∞—Ö¬ª. |
| –°–∫–∞–Ω–µ—Ä –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã) | Graceful degradation: –±–µ–∑ –∫–∞–º–µ—Ä—ã –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞. |
| –ö–µ—à –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ | –û–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã (—Ö—É–∫–∏), refetch –ø—Ä–∏ —è–≤–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ –∏ –ø–æ —Ç–∞–π–º–µ—Ä—É —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ. |

---

## –ü–æ—Å–ª–µ —Å–ø—Ä–∏–Ω—Ç–∞ 2.3

**–ì–æ—Ç–æ–≤–æ:**  
- –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞ –∏ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–æ—Å—ã–ª–∫–∞–º–∏ (Delivered/Lost).  
- –ß–µ—Ç—ã—Ä–µ –≤–∏–¥–∞ Dashboard (–ó–∞–∫–∞–∑—ã, –ü–æ—Å—ã–ª–∫–∏, –¢–æ–≤–∞—Ä—ã, –°—Ç–∞—Ç—É—Å).  
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–ø—Ä–æ—Å—É –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ —Ç–∞–π–º–µ—Ä—É.  
- –†–µ–∂–∏–º –ø—Ä–∏—ë–º–∫–∏: –ø–æ–∏—Å–∫ –ø–æ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä—É –ø–æ –∫–µ—à—É, mark-received; –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Å–∫–∞–Ω–µ—Ä.

**–î–∞–ª—å—à–µ (–±—ç–∫–ª–æ–≥):**  
- LLM Vision Import (–ø–µ—Ä–µ–Ω–µ—Å—ë–Ω —Å 2.1).  
- Tracking queue (Redis/Celery), —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ protection deadline.  
- PWA, –æ—Ñ–ª–∞–π–Ω, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º.  
- Frontend-—Ç–µ—Å—Ç—ã (Vitest), –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry).  

---

**–î–æ–∫—É–º–µ–Ω—Ç:** –ü–ª–∞–Ω —Å–ø—Ä–∏–Ω—Ç–∞ 2.3  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 15 —Ñ–µ–≤—Ä–∞–ª—è 2026
