# UAT Checklist (Executable)

## 1) Подготовка тестовых данных

- Создать тестовый заказ `ORDER-UAT-001` с 2 позициями:
  - `SKU-A`, qty `2`, price `50.00` RUB
  - `SKU-B`, qty `1`, price `99.99` RUB
- Создать посылку `TRK-UAT-001` и связать позиции заказа с этой посылкой.
- Подготовить "грязный" JSON от LLM:

```text
LLM says:
```json
{"order_id": "ORDER-UAT-001", "items": [{"sku":"SKU-A","qty":2,"price":50.00},{"sku":"SKU-B","qty":1,"price":99.99}]}
```
```

## 2) Чеклист приемки

- [ ] Импорт LLM JSON: корректно извлекается JSON из оберток текста/markdown.
- [ ] Неполный JSON: поля `order_id`, `sku`, `qty`, `price` заполняются дефолтами.
- [ ] Конвертация валют:
  - [ ] сумма `0` корректно сохраняется как `0.00`.
  - [ ] отрицательные значения сохраняют знак после конвертации.
  - [ ] округление делается по правилу `HALF_UP` до 2 знаков.
- [ ] FK ограничения:
  - [ ] невозможно создать `OrderItem` с несуществующим `parcel_id`.
- [ ] Tracking обновление:
  - [ ] статус меняется при каждом ответе tracking-service (`created -> in_transit -> delivered`).
- [ ] CSV экспорт:
  - [ ] сумма по строкам CSV совпадает с агрегатом в БД.

## 3) Автоматизированные проверки (локально)

```bash
pytest -q
```

Ожидаемо: все unit + integration тесты проходят.
